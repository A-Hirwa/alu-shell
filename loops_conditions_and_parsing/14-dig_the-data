#!/usr/bin/env bash
# Group visitors by IP and HTTP status code, then display the occurrence number in descending order

# Make sure the log file exists
LOG_FILE="apache-access.log"

if [[ ! -f $LOG_FILE ]]; then
    echo "Log file not found: $LOG_FILE"
    exit 1
fi

# Use awk to extract the IP and HTTP status code, sort them, count occurrences, and sort by number of occurrences
awk '{print $1, $9}' "$LOG_FILE" | sort | uniq -c | sort -nr | awk '{printf "%8d %s %s\n", $1, $2, $3}'

